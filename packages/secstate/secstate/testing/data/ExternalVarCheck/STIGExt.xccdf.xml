<?xml version="1.0" encoding="UTF-8"?>
<!-- This XCCDF document was auto generated by the Recommendation Tracker. -->
<Benchmark xmlns="http://checklists.nist.gov/xccdf/1.1"
           xmlns:dc="http://purl.org/dc/elements/1.1/"
           xmlns:cdf="http://checklists.nist.gov/xccdf/1.1"
           xmlns:cpe="http://cpe.mitre.org/dictionary/2.0"
           xmlns:dsig="http://w3.org/2000/09/xmldsig#"
           xmlns:xhtml="http://www.w3.org/1999/xhtml"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.1 http://nvd.nist.gov/schema/xccdf-1.1.4.xsd"
           id="STIGExt">
<!-- Review the status value. -->
<status date="2010-05-25">draft</status>
   <title>STIG External Variable Test</title>
   <!-- Consider adding front-matter. -->

<!-- Consider adding rear-matter. -->
<!-- Consider adding a reference for the benchamrk. -->
<!-- Consider adding application wide plafrom information. -->

<!-- Review version information. -->
<version>1.0</version>
   <!-- Consider adding scoring model information. -->
<Group id="STIGExt-G-2-1" selected="true">
      <title>Password Controls</title>
      <description>UNIX operating systems allow specification of a password. </description>
      <question/>
      <Group id="STIGExt-G-2-2" selected="true">
         <title>Password Guidelines</title>
         <description>Apply the required information assurance controls for the Mission Assurance Category (MAC) and Confidentiality Level in accordance with Enclosure 4, DODI 8500.2. Modern UNIX systems accomplish this by encrypting passwords and placing them into a protected file that is separate from, and more secure than, the /etc/passwd file. Implementation of the password protection scheme is listed below and is dependent on the flavor of UNIX used:
    1. In most System V, Solaris, Linux, and IRIX systems this is implemented via the /etc/shadow file.
</description>
         <question/>
         <Value id="STIGExt-V-2-5" type="string" operator="greater than or equal">
            <title>Minimum Password Length</title>
            <description>Variable containing the minimum password lenth</description>
            <value>8</value>
         </Value>
         <Value id="STIGExt-V-2-36" type="string" operator="greater than or equal">
            <title>Minimum Password Length</title>
            <description>Variable containing the minimum password length</description>
            <value>8</value>
         </Value>
         <Value id="STIGExt-V-2-11" type="string" operator="greater than or equal">
            <title>Minimum Uppercase Characters</title>
            <description>The number specified to be the minimum number of uppercase characters within a password.</description>
            <value>1</value>
         </Value>
         <Value id="STIGExt-V-2-15" type="string" operator="greater than or equal">
            <title>Minimum Lowercase Characters</title>
            <description>The minimum lowercase letters required when creating a password.</description>
            <value>2</value>
         </Value>
         <Value id="STIGExt-V-2-17" type="string" operator="greater than or equal">
            <title>Minimum Number of Numeric Characters</title>
            <description>Contains the minimum number of numeric characters allowed in a password.</description>
            <value>1</value>
         </Value>
         <Value id="STIGExt-V-2-25" type="string" operator="greater than or equal">
            <title>Password Minimum Special Character Check</title>
            <description>Minimum number of special characters allowed in a password.</description>
            <value>1</value>
         </Value>
         <Value id="STIGExt-V-2-34" type="string" operator="less than or equal">
            <title>Password Number Days Valid</title>
            <description>Maximum number of days a password is valid.</description>
            <value>90</value>
         </Value>
         <Rule id="STIGExt-R-2-1" selected="true" role="full">
            <title>GEN000580 - Password Minimum Length</title>
            <description>If a password does not contain a minimum of n characters, this is a finding.  In this case, n will be specified during testing as an external variable.</description>
            <question/>
            <rationale>This provides for more security through higher password complexity.<xhtml:br/>
               <xhtml:strong>Impact If Not Followed:</xhtml:strong>
               <xhtml:table xhtml:width="100%">
                  <xhtml:tr>
                     <xhtml:td>
                        <xhtml:strong>Level: </xhtml:strong>High</xhtml:td>
                     <xhtml:td>
                        <xhtml:strong>Type: </xhtml:strong>Network Security</xhtml:td>
                  </xhtml:tr>
                  <xhtml:tr>
                     <xhtml:td xhtml:colspan="2">Category II:
Vulnerability that provides information that has a high potential of giving access to an intruder.</xhtml:td>
                  </xhtml:tr>
               </xhtml:table>
            </rationale>
            <fixtext>There are two possible methods of verifying this requirement.
1.  Verify that PASS_MIN_LEN in /etc/login.defs is set to the minimum value required.
2.  Verify that within /etc/pam.d/system-auth that on the line that states "password (required|requisite) pam_cracklib.so" there is minlen=N.  N being the minimum password length required.<xhtml:br/>
               <xhtml:strong>1: </xhtml:strong>grep PASS_MIN_LEN /etc/login.defs<xhtml:br/>
               <xhtml:strong>2: </xhtml:strong>egrep "password.*(required|requisite).*pam_cracklib\.so.*minlen=.*" /etc/pam.d/system-auth</fixtext>
            <complex-check operator="OR">
                <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <check-export value-id="STIGExt-V-2-5" export-name="oval:com.tresys.oval.rhel:var:1004"/>
                    <check-content-ref href="2-6GEN000580-PamPasswordMinLin.xml"
                                      name="oval:com.tresys.oval.rhel:def:1000"/>
                </check>
                <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
                    <check-export value-id="STIGExt-V-2-36" export-name="oval:com.tresys.oval.rhel:var:1032"/>
                    <check-content-ref href="2-37GEN000580-PasswordMinLength.xml"
                                      name="oval:com.tresys.oval.rhel:def:1005"/>
                </check>
            </complex-check>
         </Rule>
         <Rule id="STIGExt-R-2-2" selected="true" role="full">
            <title>GEN000600 - Password Minimum Upper and Lowercase</title>
            <description>The IAO will ensure that passwords include at least n alphabetic characters and n are capitalized.  In this case, n will be specified during testing as an external variable.</description>
            <question/>
            <rationale>This provides for more security through higher password complexity.<xhtml:br/>
               <xhtml:strong>Impact If Not Followed:</xhtml:strong>
               <xhtml:table xhtml:width="100%">
                  <xhtml:tr>
                     <xhtml:td>
                        <xhtml:strong>Level: </xhtml:strong>High</xhtml:td>
                     <xhtml:td>
                        <xhtml:strong>Type: </xhtml:strong>Network Security</xhtml:td>
                  </xhtml:tr>
                  <xhtml:tr>
                     <xhtml:td xhtml:colspan="2">Category II:
Vulnerability that provides information that has a high potential of giving access to an intruder.</xhtml:td>
                  </xhtml:tr>
               </xhtml:table>
            </rationale>
            <fixtext>Verify within pam (/etc/pam.d/system-auth that the parameters for minimum upper and lowercase letters are specified.<xhtml:br/>
               <xhtml:strong>1: </xhtml:strong>egrep "password.*(required|requisite).*pam_cracklib\.so.*ucredit=-?[0-9]*" /etc/pam.d/system-auth<xhtml:br/>
               <xhtml:strong>2: </xhtml:strong>egrep "password.*(required|requisite).*pam_cracklib\.so.*lcredit=-?[0-9]*" /etc/pam.d/system-auth</fixtext>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export value-id="STIGExt-V-2-11" export-name="oval:com.tresys.oval.rhel:var:1016"/>
               <check-export value-id="STIGExt-V-2-15" export-name="oval:com.tresys.oval.rhel:var:1015"/>
               <check-content-ref href="2-12GEN000600-PamPasswordComplexityMinUpperLower.xml"
                                  name="oval:com.tresys.oval.rhel:def:1010"/>
            </check>
         </Rule>
         <Rule id="STIGExt-R-2-3" selected="true" role="full">
            <title>GEN000620 - Password Minimum Numeric</title>
            <description>A password should contain a minimum number of numeric characters within a password.</description>
            <question/>
            <rationale>This provides for more security through higher password complexity.<xhtml:br/>
               <xhtml:strong>Impact If Not Followed:</xhtml:strong>
               <xhtml:table xhtml:width="100%">
                  <xhtml:tr>
                     <xhtml:td>
                        <xhtml:strong>Level: </xhtml:strong>High</xhtml:td>
                     <xhtml:td>
                        <xhtml:strong>Type: </xhtml:strong>Network Security</xhtml:td>
                  </xhtml:tr>
                  <xhtml:tr>
                     <xhtml:td xhtml:colspan="2">Category II:
Vulnerability that provides information that has a high potential of giving acess to an intruder.</xhtml:td>
                  </xhtml:tr>
               </xhtml:table>
            </rationale>
            <fixtext>Verify that within /etc/pam.d/system-auth, the dcredit variable has been set on the pam_cracklib.so line.<xhtml:br/>
               <xhtml:strong>1: </xhtml:strong>egrep "password.*(required|requisite).*pam_cracklib\.so.*dcredit=-?[0-9]*" /etc/pam.d/system-auth</fixtext>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export value-id="STIGExt-V-2-17" export-name="oval:com.tresys.oval.rhel:var:1020"/>
               <check-content-ref href="2-18GEN000620-PasswordComplexityNumeric.xml"
                                  name="oval:com.tresys.oval.rhel:def:1017"/>
            </check>
         </Rule>
         <Rule id="STIGExt-R-2-4" selected="true" role="full">
            <title>GEN000640 - Password Minimum Special Character</title>
            <description>Passwords must contain at least n special characters.  In this case, n will be provided via an external variable.</description>
            <question/>
            <rationale>This provides for more security through higher password complexity.</rationale>
            <fixtext>Verify within /etc/pam.d/system-auth that the pam_cracklib.so line contains the ocredit variable declaration.<xhtml:br/>
               <xhtml:strong>1: </xhtml:strong>egrep "password.*(required|requisite).*pam_cracklib\.so.*ocredit=-?[0-9]*" /etc/pam.d/system-auth</fixtext>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export value-id="STIGExt-V-2-25" export-name="oval:com.tresys.oval.rhel:var:1024"/>
               <check-content-ref href="2-26GEN000640-PasswordComplexitySpecial.xml"
                                  name="oval:com.tresys.oval.rhel:def:1021"/>
            </check>
         </Rule>
         <Rule id="STIGExt-R-2-5" selected="true" role="full">
            <title>GEN000660 - Password No Personal or Dictionary Information</title>
            <description>Passwords should not contain any personal or dictionary information.</description>
            <question/>
            <rationale>This provides for more security through higher password complexity.<xhtml:br/>
               <xhtml:strong>Impact If Not Followed:</xhtml:strong>
               <xhtml:table xhtml:width="100%">
                  <xhtml:tr>
                     <xhtml:td>
                        <xhtml:strong>Level: </xhtml:strong>High</xhtml:td>
                     <xhtml:td>
                        <xhtml:strong>Type: </xhtml:strong>Network Security</xhtml:td>
                  </xhtml:tr>
                  <xhtml:tr>
                     <xhtml:td xhtml:colspan="2">Category II:
Vulnerability that provides information that has a high potential of giving access to an intruder.</xhtml:td>
                  </xhtml:tr>
               </xhtml:table>
            </rationale>
            <fixtext>In most cases, this is a manual check of site policy.</fixtext>
         </Rule>
         <Rule id="STIGExt-R-2-6" selected="true" role="full">
            <title>GEN000680 - Password No Consecutive Characters</title>
            <description>Passwords must contain no consecutive characters.</description>
            <question/>
            <rationale>This provides for more security through higher password complexity.<xhtml:br/>
               <xhtml:strong>Impact If Not Followed:</xhtml:strong>
               <xhtml:table xhtml:width="100%">
                  <xhtml:tr>
                     <xhtml:td>
                        <xhtml:strong>Level: </xhtml:strong>High</xhtml:td>
                     <xhtml:td>
                        <xhtml:strong>Type: </xhtml:strong>Network Security</xhtml:td>
                  </xhtml:tr>
                  <xhtml:tr>
                     <xhtml:td xhtml:colspan="2">Category II:
Vulnerability that provides information that has a high potential of giving access to an intruder.</xhtml:td>
                  </xhtml:tr>
               </xhtml:table>
            </rationale>
            <fixtext>Verify within /etc/pam.d/system-auth that the pam_cracklib.so line contains the maxrepeat variable declaration.<xhtml:br/>
               <xhtml:strong>1: </xhtml:strong>egrep "password.*(required|requisite).*pam_cracklib\.so.*maxrepeat=-?[0-9]*" /etc/pam.d/system-auth</fixtext>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-content-ref href="2-30GEN000680-PamPasswordNoRepeat.xml"
                                  name="oval:com.tresys.oval.rhel:def:1030"/>
            </check>
         </Rule>
         <Rule id="STIGExt-R-2-7" selected="true" role="full">
            <title>GEN000700 - Password Change Every Number Days</title>
            <description>Passwords must be changed at a maximum of ever n days.  In this case, n will be provided as an external variable.</description>
            <question/>
            <rationale>The more often the password is changed, the more secure the system becomes as it becomes harder to guess or brute force passwords.<xhtml:br/>
               <xhtml:strong>Impact If Not Followed:</xhtml:strong>
               <xhtml:table xhtml:width="100%">
                  <xhtml:tr>
                     <xhtml:td>
                        <xhtml:strong>Level: </xhtml:strong>High</xhtml:td>
                     <xhtml:td>
                        <xhtml:strong>Type: </xhtml:strong>Network Security</xhtml:td>
                  </xhtml:tr>
                  <xhtml:tr>
                     <xhtml:td xhtml:colspan="2">Category II:
Vulnerability that provides information that has a high potential of giving access to an intruder.</xhtml:td>
                  </xhtml:tr>
               </xhtml:table>
            </rationale>
            <fixtext>Verify within the shadow file that all users have the maximum n days a password is valid, set.
user:password:passlastchanged:mindayschanged:maxdaysvalid:*<xhtml:br/>
               <xhtml:strong>1: </xhtml:strong>cat /etc/<xhtml:br/>
               <xhtml:strong>2: </xhtml:strong>user:password:passlastchanged:mindayschanged:maxdaysvalid:*</fixtext>
            <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
               <check-export value-id="STIGExt-V-2-34" export-name="oval:com.tresys.oval.rhel:var:1029"/>
               <check-content-ref href="2-35GEN000700-PasswordChangeEvery90DaysOrLess.xml"
                                  name="oval:com.tresys.oval.rhel:def:1025"/>
            </check>
         </Rule>
      </Group>
   </Group>
   <Profile id="emptyProfile">
     <title>An empty profile</title>
   </Profile>
   <!-- TODO: Test configuration is not currently supported in the generated xccdf. --></Benchmark>
